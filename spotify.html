<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spotify Downloader</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif}
body{background:#0b0f1a;color:#fff;min-height:100vh}

/* Top Bar */
.topbar{
    padding:15px 20px;
    background:#11162a;
    border-bottom:1px solid #ffffff;
    display:flex;
    align-items:center;
    gap:12px;
}

.back-btn{
    width:40px;
    height:40px;
    display:flex;
    align-items:center;
    justify-content:center;
    border-radius:10px;
    background:#0f1530;
    color:#1db954;
    text-decoration:none;
    font-size:18px;
}

.title-text{font-size:20px;font-weight:600}

/* Main */
.container{max-width:900px;margin:auto;padding:20px}
.box{background:#11162a;padding:20px;border-radius:14px}
.box h2{font-size:18px;margin-bottom:15px;color:#1db954}
.input{width:100%;padding:12px;border-radius:10px;border:none;outline:none;font-size:14px}
.btn{margin-top:12px;width:100%;padding:12px;border:none;border-radius:10px;background:#1db954;color:#fff;font-size:15px;cursor:pointer}

.result{margin-top:20px}
.track{background:#0f1530;padding:15px;border-radius:12px;margin-top:10px;text-align:center}
.track img{width:100%;border-radius:10px}
.track h4{margin:10px 0 5px}
.track p{margin:5px 0;color:#aaa}
.track a{display:inline-block;margin-top:8px;padding:8px 16px;background:#1db954;color:#fff;text-decoration:none;border-radius:50px;font-weight:600;transition:0.3s}
.track a:hover{background:#17a44d}
.footer{text-align:center;padding:18px;font-size:12px;opacity:0.6}
</style>
</head>

<body>

<!-- Top Bar -->
<div class="topbar">
    <a href="index.html" class="back-btn">
        <i class="fas fa-arrow-left"></i>
    </a>
    <div class="title-text">Spotify Downloader</div>
</div>

<!-- Content -->
<div class="container">
    <div class="box">
        <h2><i class="fab fa-spotify"></i> Paste Spotify Track URL</h2>
        <input class="input" id="url" placeholder="https://open.spotify.com/track/..." />
        <button class="btn" onclick="download()">Fetch Track</button>

        <div class="result" id="result"></div>
    </div>
</div>

<div class="footer">All right reserved Â© by Tech AD</div>

<script>
async function download(){
    const url = document.getElementById('url').value;
    const resBox = document.getElementById('result');
    resBox.innerHTML = "Loading...";

    try {
        const res = await fetch('/api/spotify?url=' + encodeURIComponent(url));
        const data = await res.json();

        if(data.statusCode !== 200 || !data.medias || data.medias.length === 0){
            resBox.innerHTML = "Failed to fetch track";
            return;
        }

        let html = `<div class="track">
            <img src="${data.thumbnail}" alt="Thumbnail">
            <h4>${data.title}</h4>
            <p>Duration: ${data.duration}</p>
            <a href="${data.medias[0].url}" target="_blank" download="${data.title}.${data.medias[0].extension}">Download HQ</a>
        </div>`;

        resBox.innerHTML = html;

    } catch(err){
        console.error(err);
        resBox.innerHTML = "Failed to fetch track";
    }
}
</script>

</body>
</html>